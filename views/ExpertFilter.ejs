<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel = "stylesheet" href = "stylesheets/ExpertFilter.css">
</head>
<body>
    <header>
        <nav>
            <ul>
                <li><a href = "/ExpertFilter">예약하기</a></li>
                <li><a href = "/reserveInfo">예약정보</a></li>
                <li><a href = "/mypage">회원정보</a></li>
            </ul>
        </nav>
    </header>
        <p>"타로전문가의 조건을 선택해주세요"</p>
        <section>
            <div class = "filter">
                <form method="post">
                    <label for="region">지역</label><br>
                    <% const regions = ['서울', '인천', '대전', '광주', '부산', '대구']; %>
                    <% for (let i = 0; i < regions.length; i++) { %>
                        <input type="radio" name="region" value="<%= i + 1 %>"><%= regions[i] %>
                    <% } %>
                    <br>
                    
                    <label for="expertise">전문분야</label><br>
                    <% const expertise = ['연애운', '결혼운', '이사운', '금전운', '직장운']; %>
                    <% for (let i = 0; i < expertise.length; i++) { %>
                        <input type="radio" name="expertise" value="<%= i + 1 %>"><%= expertise[i] %>
                    <% } %>
                    <br>
                
                    <label for="maxPrice">최고가격대(만원)</label><br>
                    <select name="maxPrice">
                        <% const maxPrices = [1, 2, 3, 4, 5, 6]; %>
                        <% for (let i = 0; i < maxPrices.length; i++) { %>
                            <option value="<%= i + 1 + regions.length + expertise.length %>"><%= maxPrices[i] %></option>
                        <% } %>
                    </select>
                    <br>
                
                    <label for="minPrice">최저가격대(만원)</label><br>
                    <select name="minPrice">
                        <% const minPrices = [1, 2, 3, 4, 5,6]; %>
                        <% for (let i = 0; i < minPrices.length; i++) { %>
                            <option value="<%= i + 1 + regions.length + expertise.length + maxPrices.length %>"><%= minPrices[i] %></option>
                        <% } %>
                    </select>
                    <br>
                
                    <input type="submit" value="검색하기">
                </form>
            </div>
        </section>
    <script>
        document.getElementById('filterForm').addEventListener('submit', function(event) {
            event.preventDefault(); // 폼 제출 기본 동작을 막음

            // FormData 객체 생성
            const formData = new FormData(this);

            // FormData를 JSON으로 변환
            const jsonData = {};
            formData.forEach((value, key) => {
                jsonData[key] = value;
            });

            // 서버로 JSON 데이터 전송
            fetch('/api/filterData', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(jsonData)
            })
            .then(response => response.json())
            .then(data => {
                // 서버 응답에 따른 동작 수행
                console.log('서버 응답:', data);
                window.location.href = '/ExpertList'; // 원하는 페이지로 이동
            })
            .catch(error => console.error('Error sending data:', error));
        });
    </script>
</body>
</html>